<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>数据标准</title>
    <link href="lib/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="lib/jquery-3.2.1.min.js"></script>
    <script src="lib/bootstrap/js/bootstrap.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="lib/bootstrap-table/bootstrap-table.min.css">

    <link href="css/table.css" rel="stylesheet">
    <!-- Latest compiled and minified JavaScript -->
    <script src="lib/bootstrap-table/bootstrap-table.min.js"></script>

    <!-- Latest compiled and minified Locales -->
    <script src="lib/bootstrap-table/bootstrap-table-zh-CN.min.js"></script>

    <style>
        html, body {
            background: #12141B;
            color: #ccc;
            height: 100%;
        }

        a {
            color: #ccc;
        }

        a:hover, a:focus {
            color: #ccc;
        }

        .breadcrumb-nav {
            height: 75px;
            padding: 20px 40px 20px 40px;
            font-size: 0;
            background: #262C37;
        }

        .breadcrumb-nav .breadcrumb-svg {
            height: 30px;
            width: 30px;
            vertical-align: top;
            margin-right: 10px;
        }

        .breadcrumb-nav .breadcrumb-span {
            font-size: 24px;
        }

        .docker .right-main .action_btns .btn {
            margin-bottom: 5px;
        }

        #addModal, #loadModal {
            color: #333;
        }

        #addModal .modal-header, #loadModal .modal-header {
            background-color: #32507A;
            color: #fff;
        }

        #addModal .close, #loadModal .close {
            color: #fff;
        }
        .btn-wrapper{
            margin: 30px 0 20px 35px;
            font-size: 0;
        }
        .addModalBtn{
            margin-right: 10px;
        }
        .addModalBtn, .loadModalBtn{
            width: 59px;
            height: 32px;
            background: #4A90E2;
            border-radius: 3px;
        }
        .search-div{
            float: right;
            width: 240px;
            height: 32px;
            line-height: 27px;
            margin-right: 40px;
            border: 1px solid #32507A;
            border-radius: 3px;
        }
        .search-input{
            background-color: #12141B;
            border:none;
        }
        input::-webkit-input-placeholder{
            padding-left:15px;
            color: #404144;
        }
        input:-moz-placeholder{
            padding-left:15px;
            color: #404144;
        }
        input:-ms-input-placeholder{
            padding-left:15px;
            color: #404144;
        }
        .search-i{
            float: right;
            width: 30px;
            height: 30px;
            margin-bottom: 7px;
        }
        .table-wrapper{
            margin: 0 40px 0 35px;
        }
        #dm-table thead{
            height: 44px;
            background-color: #2d3543;
            font-weight: normal;
            font-size: 12px;

        }
        #dm-table>thead>tr>th {
            /*padding-left: 15px;*/
            border-bottom: 2px solid #5792E5;
        }
        #dm-table>tbody>tr>td{
            padding: 0;
        }
        #dm-table>tbody>tr>td{
            height: 40px;
            line-height: 40px;
            padding-left: 10px;
            background: #1C2331;
            font-weight: normal;
            font-size: 12px;
            border-bottom: 1px solid #32507A;
        }
        #dm-table>tbody>tr:hover,#dm-table>tbody a:hover{
            color:#5792E5;
        }
        #dm-table .glyphicon{
            color: #4A90E2;
            padding-left: 3px;
        }
        .btn-wrong{
            background-color: #545c6d;
        }
        .btn-reject{
            background-color: #F8576A;
        }
    </style>
</head>
<body>
<div class="left-nav-wrap">
    <script>
        $('.left-nav-wrap').load('leftNav-black.html');
    </script>
</div>
<div class="top-wrap">
    <script>
        $('.top-wrap').load('fix-top-black.html');
    </script>
</div>
<div class="right" style="margin-left: 200px; height: 100%;">
    <div class="appStore" style="height: 100%">
        <div class="breadcrumb-nav">
            <img src="image/svg/appStore.svg" class="breadcrumb-svg" alt=""/>
            <span class="breadcrumb-span"><a href="tomcat-black.html">数据标准</a></span>
        </div>
        <div class="docker">
            <div class="right-main">
                <div class="btn-wrapper" style="margin-bottom: 0">
                    <!--<button class="btn btn-primary addModalBtn"  data-toggle="modal" data-target="#addModal">添加</button>
                    <button class="btn btn-primary loadModalBtn" data-toggle="modal" data-target="#loadModal">导入</button>
                    <div class="search-div">
                        <input type="text" class="search-input" placeholder="搜索字段"/>
                        <img src="image/search-i.svg" class="search-i" alt=""/>

                    </div>-->
                    <div class="detail-type" style="display: inline-block;width:calc(100% - 40px);border-bottom: 1px solid #3D5B77">

                        <div id="area_tabs" class="btn-group btn-group-xs" role="group" aria-label="...">
                            <button type="button" class="btn" onclick="initTable('B域')"
                                style="padding:3px 10px 0 8px;border-radius: 5px 5px 0 0;font-size:14px;margin-right:1px;background-color: #5EA3F8;color: white">
                                B域
                            </button>
                            <button type="button" class="btn" onclick="initTable('O域')"
                                style="padding:3px 10px 0 8px;border-radius: 5px 5px 0 0;font-size:14px;margin-right:1px;background-color: #3D5B77;color: white">
                                O域
                            </button>
                            <button type="button" class="btn" onclick="initTable('M域')"
                                style="padding:3px 10px 0 8px;border-radius: 5px 5px 0 0;font-size:14px;margin-right:1px;background-color: #3D5B77;color: white">
                                M域
                            </button>
                        </div>
                        <button id="goback" type="button" class="btn pull-right" onclick="goback()"
                                style="padding:3px 10px 0 8px;border-radius: 5px 5px 0 0;
                                font-size:14px;margin-right:1px;background-color: #5EA3F8;
                                color: white;display: none">
                                返回
                            </button>
                    </div>
                </div>
                <div class="table-wrapper standard">
                    <table class="table" id="dm-table">
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>
<script>
function initTable(type) {
    var bareadata = 'data/b_area_interface.json';
    var oareadata = 'data/o_area_interface.json';
    var mareadata = 'data/m_area_interface.json';
    $(".detail-type").find("button").each(function () {
        var text = $(this).text().trim();
        if (text == type) {
            $(this).css('background-color', '#5EA3F8');
        } else {
            $(this).css('background-color', '#3D5B77');
        }
    });
    var url = 'data/';
    var exactWayName = "", org_sys_en, org_sys_cn;
    if (type == "B域") {
        url += 'b-area-ods-catalog.json';
        exactWayName = 'exact_way';
        org_sys_cn = "origin_system_zh";
        org_sys_en = "origin_system_en";
    } else if (type == "O域") {
        url += 'o-area-ods-catalog.json';
        exactWayName =  'get_data__way';
        org_sys_cn = "origin_system_tablename_cn";
        org_sys_en = "origin_system_tablename_en";

    } else if (type == "M域") {
        url += 'm-area-ods-catalog.json';
        exactWayName = 'exact_way';
        org_sys_cn = "origin_system_zh";
        org_sys_en = "origin_system_en";
    }
    var columns = [{
        field: 'interface_code',
        title: '接口编码',
        formatter: function (cell) {
            return '<a href="javascript:void(0)">' + cell + '<i class="glyphicon glyphicon-tags"></i></a>';
        },
        events: {
            'click a': function (event, value, row, index) {
                var ids = ['14016', '14017', '14018', '17001', '17003', '17004', '28301', '28302', '28303'];
               if(ids.indexOf(value)>-1) {
                   initDetailTable(value, type);
                   $("#area_tabs").css('display', 'none');
                   $("#goback").css('display', "inline-block");
               }
                /*if (value == 16305 || value == 16099) {
                    openAppModal(row);
                }*/
            }
        }
    }, {
        field: org_sys_cn,
        title: '源系统表名（中文）',
    }, {
        field: org_sys_en,
        title: '源系统表名（英文）',
    }, {
        field: 'interface_way',
        title: '接口方式',
    }, {
        field: 'field_enclosed',
        title: '字段分隔符',
    }, {
        field: 'record_enclosed',
        title: '记录分隔符',
        visible: false,
    }, {
        field: 'file_format',
        title: '文件编码格式',
        visible: false,
    }, {
        field: exactWayName,
        title: '采集方式',
    }, {
        field: 'acquire_frequency',
        title: '采集频率',
        formatter: function (cell) {
            return '<span class="label" style="background-color: #A089CF;font-weight: 100;">' + cell+'';
        }
    }];

    $("#dm-table").bootstrapTable('destroy').bootstrapTable({
        method: 'get',
        url: url,
        cache: false,
        pagination: true,
        pageSize: 15,
        pageList: [5, 10, 15, 20],
        columns: columns,
        responseHandler: function (res) {
            var rows = [];
            if (type == "B域") {
                rows = res.b_area_ods_catalog;
                rows = rows.slice(1, rows.length);

            } else if (type == "O域") {
                rows = res.o_area_ods_catalog;
            } else if (type == "M域") {
                rows = res.m_area_ods_catalog;
                rows = rows.slice(1, rows.length);

            }
            return rows;
        }
    });

}
    initTable("B域");
    function initDetailTable(id, type) {
        var url = 'data/';
        if(type=="B域") {
            url += 'b-area-ods-';
        } else if(type == "O域") {
            url += 'o-area-ods-';
        } else if(type == "M域") {
            url += 'm-area-ods-';
        }
        url += id+".json";
        var columns = [
            {
                field: 'property_code',
                title: '属性编码',
                align: 'center',
                visible: false
            }, {
                field: 'property_en',
                title: '属性英文名称',
            }, {
                field: 'property_zh',
                title: '属性中文名称',
            }, {
                field: 'date_type',
                title: '类型',
            }, {
                field: 'date_type_bdi',
                title: '数据类型BDI',
            }, {
                field: 'property_describe',
                title: '属性描述',
            }
        ];
        $("#dm-table").bootstrapTable('destroy').bootstrapTable({
        method: 'get',
        url: url,
        cache: false,
        pagination: true,
        pageSize: 10,
        pageList: [5, 10, 15, 20],
        columns: columns,
        responseHandler: function (res) {
            var rows = [];
            if (type == "B域") {
                rows = res['b_area_ods_'+id];
            } else if (type == "O域") {
                rows = res['o_area_ods_'+id];
            } else if (type == "M域") {
                rows = res['m_area_ods_'+id];
            }
            return rows;
        }
    });
    }
    function goback() {
        $("#area_tabs").css('display', 'inline-block');
        $("#goback").css('display', "none");
        initTable("B域")
    }
</script>
</body>
</html>